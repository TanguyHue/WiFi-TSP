\section{Fonctionnement des Protocoles Wi-Fi}
\label{sec:protocoles}

La sécurité des réseaux Wi-Fi repose sur une succession de mécanismes cryptographiques introduits progressivement pour corriger les vulnérabilités de leurs prédécesseurs. Depuis WEP en 1997 jusqu'à WPA3 en 2018, chaque protocole a apporté des évolutions majeures : nouveaux algorithmes, nouvelles principes cryptographiques, mécanismes d'intégrité plus robustes, protection des trames de gestion, et résistance aux attaques hors ligne. Cette section propose une analyse approfondie de ces mécanismes, de leur logique interne, de leurs limites, ainsi que des structures de trames qu'ils manipulent.

\subsection*{Définitions générales Wi-Fi}

Avant d’aborder en détail le fonctionnement des différents protocoles de sécurité, il est utile de préciser brièvement certains termes fondamentaux du Wi-Fi. Le \textbf{SSID} (\textit{Service Set Identifier}) correspond au nom d’un réseau et permet aux dispositifs de l’identifier lors de la phase de découverte. Le \textbf{BSSID}, quant à lui, désigne l’adresse MAC unique du point d’accès assurant la diffusion du réseau. Le terme \textbf{AP} (\textit{Access Point}) désigne ce même point d’accès, tandis que la \textbf{STA} (station) représente tout client Wi-Fi, qu’il s’agisse d’un ordinateur, d’un smartphone ou d’un objet connecté.

\begin{figure}[H]
\centering
\begin{tikzpicture}[>=latex, node distance=3cm]

% AP au centre
\node[draw, rounded corners, align=center, inner sep=4pt] (ap) {Point d'accès (AP)\\[2pt]
\textbf{SSID} : \texttt{LabWiFi}\\
\textbf{BSSID} : \texttt{00:11:22:33:44:55}};

% Stations autour
\node[draw, rounded corners, left=of ap, align=center, inner sep=4pt] (sta1) {Station 1 (STA)\\PC portable};
\node[draw, rounded corners, right=of ap, align=center, inner sep=4pt] (sta2) {Station 2 (STA)\\Smartphone};
\node[draw, rounded corners, below=of ap, align=center, inner sep=4pt] (sta3) {Station 3 (STA)\\IoT / Objet connecté};

% Liens
\draw[<->] (ap) -- node[above]{Trames 802.11} (sta1);
\draw[<->] (ap) -- node[above]{Trames 802.11} (sta2);
\draw[<->] (ap) -- node[right]{Trames 802.11} (sta3);

\end{tikzpicture}
\caption{Illustration des notions AP, STA, SSID et BSSID dans un réseau Wi-Fi}
\label{fig:ap_sta_ssid_bssid}
\end{figure}

Les communications Wi-Fi reposent sur des trames qui circulent au niveau de la couche MAC du modèle 802.11. On distingue notamment les trames de \textit{gestion}, essentielles pour l’association, l’authentification ou la déconnexion ; les trames de \textit{contrôle}, destinées à réguler l’accès au médium ; et les trames de \textit{données}, qui transportent l’information utilisateur ou les paquets réseau encapsulés. La plupart des attaques Wi-Fi tirent parti de la possibilité d’observer, d’injecter ou de manipuler ces différentes catégories de trames.

Enfin, plusieurs notions cryptographiques apparaissent régulièrement dans ce chapitre. La \textbf{PMK} (\textit{Pairwise Master Key}) constitue le secret partagé à partir duquel toutes les clés de session sont dérivées, tandis que la \textbf{PTK} (\textit{Pairwise Transient Key}) correspond à la clé spécifique à la connexion entre un client et un point d’accès. La \textbf{GTK} (\textit{Group Temporal Key}) est utilisée pour chiffrer le trafic multicast ou broadcast adressé à plusieurs stations. Ces clés sont produites ou échangées dans le cadre de mécanismes tels que le 4-Way Handshake ou les protocoles d’authentification EAP, qui seront détaillés dans les sections suivantes.

Ces notions constituent le socle indispensable à la compréhension des protocoles de sécurisation Wi-Fi et des vulnérabilités qu’ils cherchent à prévenir.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% WEP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{WEP : Wired Equivalent Privacy}

WEP (1997) constitue la première tentative de sécuriser les communications Wi-Fi. Il a été conçu à une époque où la cryptographie grand public était encore émergente, et souffre aujourd'hui de nombreuses limitations structurelles. Son objectif était de fournir une confidentialité comparable à celle d'un réseau filaire, mais son architecture s'est révélée profondément vulnérable.

\subsubsection*{Fonctionnement interne}

WEP repose sur l'algorithme de chiffrement par flot RC4. Le mécanisme de chiffrement est simple :
\begin{itemize}
    \item une clé secrète partagée statique (40 ou 104 bits) ;
    \item un vecteur d'initialisation (IV) de 24 bits, envoyé en clair ;
    \item concaténation \texttt{IV || clé} comme entrée de RC4 ;
    \item un ICV (Integrity Check Value) calculé via CRC-32, ajouté au plaintext avant chiffrement.
\end{itemize}

Le chiffrement d'un paquet se fait ainsi :

\begin{figure}[H]
\centering
\begin{tikzpicture}[node distance=2cm]
\node[draw, rounded corners, inner sep=3pt] (pt) {Plaintext + CRC-32};
\node[draw, rounded corners, right=of pt, inner sep=3pt] (iv) {IV (24 bits)};
\node[draw, rounded corners, below=of iv, inner sep=3pt] (rc4) {RC4 KSA/PRGA};
\node[draw, rounded corners, right=of rc4, inner sep=3pt] (ks) {Keystream};
\node[draw, rounded corners, right=of pt, yshift=-10mm, inner sep=3pt] (xor) {XOR};
\node[draw, rounded corners, right=of xor, inner sep=3pt] (ct) {Ciphertext};

\draw[->] (pt) -- (xor);
\draw[->] (iv) -- (rc4);
\draw[->] (rc4) -- (ks);
\draw[->] (ks) -- (xor);
\draw[->] (xor) -- (ct);

\end{tikzpicture}
\caption{Principe du chiffrement WEP}
\label{fig:wep}
\end{figure}

\subsubsection*{Format d'une trame WEP}

\begin{figure}[H]
\centering
\begin{tikzpicture}[>=latex, node distance=0cm]

% Bloc 802.11 Header
\node[
    draw,
    minimum width=3.2cm,
    minimum height=1.1cm,
    align=center
] (hdr) {802.11\\Header};

% Bloc IV
\node[
    draw,
    minimum width=2.2cm,
    minimum height=1.1cm,
    align=center,
    right=0.1cm of hdr
] (iv) {IV\\(24 bits)};

% Bloc Données chiffrées
\node[
    draw,
    minimum width=4.8cm,
    minimum height=1.1cm,
    align=center,
    right=0.1cm of iv
] (data) {Données\\chiffrées (RC4)};

% Bloc ICV
\node[
    draw,
    minimum width=2.5cm,
    minimum height=1.1cm,
    align=center,
    right=0.1cm of data
] (icv) {ICV\\(CRC-32)};

\end{tikzpicture}
\caption{Format d'une trame WEP}
\label{fig:wep-frame}
\end{figure}

\paragraph{Faiblesses cryptographiques majeures}

\begin{itemize}
    \item IV de 24 bits : collisions quasi certaines en quelques minutes.
    \item Pas de renouvellement de clé : longue exposition.
\end{itemize}

Ces vulnérabilités rendent WEP totalement compromis : casser une clé WEP prend moins d'une minute dans des conditions favorables.

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% WPA
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{WPA : Wi-Fi Protected Access}

Face à la crise WEP, la Wi-Fi Alliance introduit en 2003 WPA comme correctif transitoire, visant à remplacer les composants vulnérables tout en conservant le matériel existant (compatibilité ascendante).

\subsubsection*{Fonctionnement interne}

WPA introduit plusieurs mécanismes :
\begin{itemize}
    \item un mélange de clés élaboré (phase 1 et phase 2) ;
    \item un compteur TSC (TKIP Sequence Counter) pour de l'anti-replay ;
    \item un MIC (Message Integrity Code) pour de l'intégrité ;
    \item une rotation des clés fréquente.
\end{itemize}

Bien que RC4 soit toujours utilisé, WPA réduit significativement les risques d'attaque sans néanmoins les éliminer.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% WPA2
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{WPA2 : AES-CCMP et le 4-Way Handshake}

WPA2 apporte une amélioration profonde : l’abandon de RC4 au profit d’un chiffrement moderne AES-CCMP.

\subsubsection*{Modes d’authentification}
\begin{itemize}
    \item \textbf{WPA2-PSK} : la PMK (\textit{Pairwise Master Key} : clé maitresse) = PBKDF2(\textit{Password-Based Key Derivation Function 2} : basée sur une passphrase et le SSID).
    \item \textbf{WPA2-Enterprise} : PMK fournie via un serveur RADIUS et une authentification EAP.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 4-Way Handshake
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Le 4-Way Handshake}

Le handshake assure :
\begin{itemize}
    \item la preuve de possession mutuelle de la PMK ;
    \item la génération de la PTK (\textit{Pairwise Transient Key}) ;
    \item la distribution de la GTK (\textit{Group Temporal Key}).
\end{itemize}

\begin{figure}[H]
\centering
\begin{tikzpicture}[>=latex]

\node (sta) at (0,0) {Client (STA)};
\node (ap)  at (6,0) {Point d'accès (AP)};

\draw (sta.south) -- ++(0,-4.5);
\draw (ap.south)  -- ++(0,-4.5);

\draw[->] (ap.south)++(0,-0.5) -- node[above,sloped]{1. ANonce} ++(-6,0);
\draw[->] (sta.south)++(0,-1.5) -- node[above,sloped]{2. SNonce + MIC} ++(6,0);
\draw[->] (ap.south)++(0,-2.5) -- node[above,sloped]{3. GTK + MIC} ++(-6,0);
\draw[->] (sta.south)++(0,-3.5) -- node[above,sloped]{4. Confirmation} ++(6,0);

\end{tikzpicture}
\caption{4-Way Handshake WPA/WPA2}
\label{fig:4way}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PMK -> PTK -> GTK derivation
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Dérivation des clés}

Au-delà de l’échange de messages représenté dans la Figure~\ref{fig:4way}, le 4-Way Handshake repose sur un mécanisme de dérivation de clés particulièrement structuré. L’ensemble du processus débute avec la PMK (Pairwise Master Key), qui constitue la base cryptographique partagée entre le client et le point d’accès. Dans le cas d’un réseau WPA2-PSK, cette PMK résulte directement de l’application d’une fonction de dérivation (PBKDF2) sur la passphrase et le SSID ; dans un environnement Enterprise, elle est fournie après l’authentification EAP par un serveur RADIUS. L’objectif du handshake n’est donc pas de négocier une nouvelle clé, mais de prouver que les deux entités possèdent bien cette PMK sans jamais la transmettre.

À partir de cette PMK, les deux parties vont dériver une clé plus large appelée PTK (Pairwise Transient Key). La construction de la PTK repose sur plusieurs éléments : l’adresse MAC du point d’accès, celle du client, ainsi que deux valeurs aléatoires appelées ANonce (envoyée par l’AP) et SNonce (envoyée par la station). Ces quatre paramètres garantissent que la PTK générée est unique pour chaque session, même si la PMK reste identique : une propriété essentielle pour éviter la réutilisation de clés et limiter les risques d’attaque par rejeu ou par corrélation.

La PTK n’est pas utilisée directement ; elle est découpée en trois sous-clés distinctes, chacune remplissant un rôle spécifique dans la sécurisation du lien. La première est la KCK (Key Confirmation Key), employée pour calculer les MIC (Message Integrity Code) des messages du handshake. Elle permet à chaque partie de vérifier que l’autre possède bien la PTK correcte, et donc implicitement la PMK. La deuxième sous-clé est la KEK (Key Encryption Key), utilisée par l’AP pour chiffrer la GTK (Group Temporal Key) transmise dans le message~3. Cette clé assure que seul un client légitime peut recevoir ou mettre à jour la clé de diffusion. Enfin, la dernière composante est la TK (Temporal Key), qui servira au chiffrement effectif du trafic unicast échangé entre la station et l’AP après la fin du handshake.

Un autre élément important est la présence de la GTK, envoyée par le point d’accès lors du message~3 du 4-Way Handshake. Contrairement à la PTK, qui est propre à une paire client–AP, la GTK est partagée entre tous les clients d’un même réseau et sert au chiffrement des trames multicast et broadcast. Sa transmission protégée par la KEK garantit qu’un attaquant passif ne peut pas l’intercepter, tandis que son renouvellement régulier limite les risques de compromission en cas d’écoute prolongée.

Ainsi, le 4-Way Handshake ne se réduit pas à un simple échange de valeurs nonces, mais constitue un véritable protocole d’initialisation cryptographique. Il assure simultanément la preuve de possession du secret initial, la dérivation de clés fraîches, l’établissement d’un canal chiffré sécurisé et la synchronisation des compteurs de trames. L’ensemble du mécanisme repose sur des propriétés formelles destinées à garantir la confidentialité et l’intégrité des échanges, tout en minimisant les risques liés à la réutilisation ou à la dérivation incorrecte des clés.

\begin{figure}[H]
\centering
\begin{tikzpicture}[>=latex, node distance=1.8cm]

\node[draw, rounded corners, inner sep=4pt] (pmk) {PMK};
\node[draw, rounded corners, below=of pmk, inner sep=4pt] (prf) {PRF(PMK, nonces, MAC)};
\node[draw, rounded corners, below=of prf, inner sep=4pt] (ptk) {PTK = KCK || KEK || TK};
\node[draw, rounded corners, right=3cm of ptk, inner sep=4pt] (gtk) {GTK};

\draw[->] (pmk) -- (prf);
\draw[->] (prf) -- node[left]{4-way handshake} (ptk);
\draw[->] (ptk.east) -- node[above]{KEK} (gtk.west);

\end{tikzpicture}
\caption{Dérivation cryptographique PMK $\rightarrow$ PTK $\rightarrow$ GTK}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CCMP frame format
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Format d'une trame CCMP (WPA2)}

\begin{figure}[H]
\centering
\begin{tikzpicture}
\node[draw, minimum width=3cm] (hdr) {802.11 Header};
\node[draw, minimum width=2cm, right=0cm of hdr] (pn) {PN};
\node[draw, minimum width=2cm, right=0cm of pn] (ccmp) {CCMP Header};
\node[draw, minimum width=4cm, right=0cm of ccmp] (data) {Payload (AES-CTR)};
\node[draw, minimum width=3cm, right=0cm of data] (mic) {MIC (CBC-MAC)};
\end{tikzpicture}
\caption{Structure d'une trame CCMP}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% WPA3 / SAE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{WPA3 : SAE, Dragonfly, GCMP et PMF}

WPA3 corrige des failles structurelles de WPA2, notamment KRACK, en introduisant SAE (Dragonfly), OWE, PMF obligatoire, et le support obligatoire de GCMP dans certaines suites.

\subsubsection*{Handshake SAE (Dragonfly)}

\begin{figure}[H]
\centering
\begin{tikzpicture}[>=latex]

\node (sta) at (0,0) {Client};
\node (ap)  at (6,0) {AP};

\draw (sta.south) -- ++(0,-4);
\draw (ap.south)  -- ++(0,-4);

\draw[->] (sta.south)++(0,-0.5) -- node[above,sloped]{Commit (scalar, element)} ++(6,0);
\draw[->] (ap.south)++(0,-1.5) -- node[above,sloped]{Commit (scalar, element)} ++(-6,0);
\draw[->] (sta.south)++(0,-2.5) -- node[above,sloped]{Confirm} ++(6,0);
\draw[->] (ap.south)++(0,-3.5) -- node[above,sloped]{Confirm} ++(-6,0);

\end{tikzpicture}
\caption{Handshake SAE (WPA3)}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SAE / GCMP crypto details
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Mécanismes cryptographiques avancés}

Les protocoles de sécurité modernes du Wi-Fi reposent sur des mécanismes cryptographiques plus élaborés que ceux utilisés par les générations précédentes. Contrairement à WEP et TKIP, qui n’offraient qu’une protection minimale contre l’écoute, l’injection ou la manipulation des trames, WPA2 et surtout WPA3 reposent sur des constructions cryptographiques complètes, conçues pour fournir à la fois confidentialité, intégrité, résistance aux attaques par rejeu et garanties formelles sur la sécurité de la session. Trois mécanismes occupent une place centrale : AES-CCMP, GCMP et SAE (aussi appelé Dragonfly). Ces primitives ne jouent pas le même rôle, mais constituent ensemble la base de la sécurité Wi-Fi contemporaine.

\subsubsection{AES-CCMP}

AES-CCMP est devenu la norme de chiffrement par défaut avec WPA2. Son objectif est d’aller bien au-delà du simple masquage des données transportées : il assure simultanément la confidentialité des informations, l’intégrité des trames et la protection contre les attaques par rejeu.

Pour y parvenir, CCMP combine deux éléments complémentaires. D’une part, il utilise AES en mode compteur (CTR) pour le chiffrement. Ce mode transforme le bloc AES en générateur de flot chiffrant, permettant de chiffrer efficacement des paquets de taille variable sans introduire de structure exploitable. De l’autre, CCMP associe ce chiffrement à un code d’authentification basé sur CBC-MAC, un mécanisme cryptographique destiné à garantir que les données n’ont subi aucune altération. Cette combinaison forme une construction dite \textit{AEAD} (Authenticated Encryption with Associated Data), dans laquelle confidentialité et intégrité sont assurées simultanément par une même clé, ce qui évite un grand nombre de vulnérabilités présentes dans les générations antérieures.

L’ensemble repose également sur un numéro de paquet (Packet Number, PN) utilisé comme nonce unique. Toute réutilisation est interdite, ce qui empêche un attaquant de rejouer ou de réinjecter des trames chiffrées. En pratique, AES-CCMP constitue encore aujourd’hui une référence en matière de chiffrement pour les réseaux Wi-Fi.

AES-CCMP combine :
\begin{itemize}
    \item AES en mode CTR pour le chiffrement ;
    \item CBC-MAC pour l'intégrité (authentification).
\end{itemize}
C'est une construction AEAD robuste, largement testée.

\subsubsection{GCMP (AES-GCM)}

GCMP, introduit avec les standards 802.11ac et repris dans WPA3-Enterprise, reprend les principes d’AES-CCMP mais s’appuie cette fois sur AES-GCM. Cette construction fait partie des modes de chiffrement AEAD les plus étudiés et les plus robustes. AES-GCM associe un chiffrement en mode CTR à la fonction d’authentification GHASH, reposant sur des opérations arithmétiques dans un corps de Galois. Cette approche permet de calculer l’intégrité et le chiffrement de façon quasi parallèle, ce qui rend GCMP particulièrement performant sur les architectures modernes.

L’intérêt principal de GCMP réside donc dans sa rapidité : il offre un débit supérieur à CCMP, ce qui le rend bien adapté aux environnements à forte charge ou aux réseaux professionnels nécessitant des débits élevés. Il reste néanmoins sensible aux erreurs d’implémentation, comme l’ont montré certaines variantes des attaques Dragonblood qui ciblaient directement GCMP-128 lorsque les nonces n’étaient pas utilisés correctement. Malgré cela, GCMP demeure une brique cryptographique robuste lorsqu’il est correctement mis en œuvre.

\subsubsection{SAE / Dragonfly}


Contrairement à AES-CCMP et à GCMP, qui sont des mécanismes de chiffrement et d’intégrité utilisés \emph{après} l’établissement de la connexion, SAE (Simultaneous Authentication of Equals) intervient au moment de l’authentification. SAE n’est pas un algorithme de chiffrement mais un protocole d’échange de clés sécurisé, faisant partie de la famille des PAKE (Password-Authenticated Key Exchange).

L’enjeu de SAE est de résoudre l’un des problèmes fondamentaux des versions antérieures : avec WPA2-PSK, un attaquant pouvait capturer un 4-Way Handshake puis tenter hors ligne de retrouver le mot de passe par dictionnaire. Dans SAE, ce type d’attaque est impossible. Le protocole s'appuie sur un échange Diffie–Hellman (sur groupes modp ou courbes elliptiques), dans lequel le mot de passe n'est jamais transmis ni dérivé sous forme exploitable. Chaque tentative d’authentification nécessite une interaction en temps réel avec le point d’accès, ce qui empêche les attaques hors ligne et limite naturellement la vitesse des tests possibles.

SAE offre également la propriété de \textit{Forward Secrecy} : même si un mot de passe venait à être compromis ultérieurement, les sessions passées resteraient inexploitables, car la clé de session résulte d’un secret éphémère renouvelé à chaque connexion. Cette approche corrige l’une des failles conceptuelles les plus importantes de WPA2 et constitue la principale amélioration de WPA3-Personal.

Pour résumer, ses caractériques principales sont les suivantes :

\begin{itemize}
    \item s’appuie sur Diffie-Hellman (modp ou ECC) ;
    \item offre Forward Secrecy ;
    \item empêche les attaques hors-ligne ;
    \item protège contre attaques dictionnaires massives.
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Format de trame GCMP
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsubsection*{Format d'une trame GCMP}

\begin{figure}[H]
\centering
\begin{tikzpicture}
\node[draw, minimum width=3cm] (hdr) {802.11 Header};
\node[draw, minimum width=2cm, right=0cm of hdr] (pn) {PN};
\node[draw, minimum width=2cm, right=0cm of pn] (gcmp) {GCMP Header};
\node[draw, minimum width=4cm, right=0cm of gcmp] (data) {Payload (AES-GCM)};
\node[draw, minimum width=3cm, right=0cm of data] (tag) {Tag (128 bits)};
\end{tikzpicture}
\caption{Structure d'une trame GCMP (WPA3)}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Synthesis table
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Synthèse comparative approfondie}

\begin{table}[H]
\centering
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{Protocole} & \textbf{Crypto} & \textbf{Auth} & \textbf{Intégrité} & \textbf{Résistance} \\
\hline
WEP & RC4 & Clé statique & CRC-32 & Nulle \\
WPA & RC4 & PSK & MIC & Faible \\
WPA2 & AES-CCMP & PSK/802.1X & CBC-MAC & Forte (hors KRACK) \\
WPA3 & AES-CCMP/GCMP & SAE/802.1X & PMF & Très forte \\
OWE & Diffie-Hellman & Aucune & CCMP/GCMP & Élevée \\
\hline
\end{tabular}
\caption{Comparaison des protocoles de sécurité Wi-Fi}
\end{table}

\newpage